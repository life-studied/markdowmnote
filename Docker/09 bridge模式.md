---
create: 2023-07-08
modified: '2025-06-08'
---

# bridge模式（默认模式）

> 在 Docker 中，**Bridge 模式** 是默认的网络模式，用于为容器提供网络连接。Bridge 模式通过创建一个虚拟的以太网桥（bridge），将容器的网络接口连接到宿主机的网络接口上，从而实现容器之间的通信以及容器与外部网络的通信。

* 旧版本：在bridge下只能通过IP去互相通信，而自定义网络里还可以通过容器名去通信（域名为容器名）。如果要通过容器名去通信，需要用--link参数去指定。
* 新版本：默认bridge或者自定义bridge都可以直接用容器名去访问彼此的IP，会自动做域名解析。

## 网络拓扑

假设你有两台宿主机，每台宿主机上都运行了多个 Docker 容器，网络拓扑如下：

```
宿主机 A
  |
  |-- docker0 (172.17.0.1)
       |
       |-- 容器 1 (172.17.0.2)
       |-- 容器 2 (172.17.0.3)

宿主机 B
  |
  |-- docker0 (172.18.0.1)
       |
       |-- 容器 3 (172.18.0.2)
       |-- 容器 4 (172.18.0.3)
```

- 宿主机 A 上的 `docker0` 桥接设备分配了 IP 地址范围 `172.17.0.0/16`。
- 宿主机 B 上的 `docker0` 桥接设备分配了 IP 地址范围 `172.18.0.0/16`。
- 容器 1 和容器 2 可以通过宿主机 A 上的 `docker0` 桥接设备进行通信。
- 容器 3 和容器 4 可以通过宿主机 B 上的 `docker0` 桥接设备进行通信。
- 容器 1 和容器 3 之间无法直接通信，因为它们属于不同的桥接网络。

```shell
# 可以通过IP和域名去ping
ping 172.17.0.2
ping 容器1
```

## bridge0-虚拟交换机

- 创建bridge0：Docker 会在宿主机上创建一个虚拟的桥接设备（默认名为 `docker0`），这个桥接设备类似于一个虚拟的交换机。
- 分配IP池：宿主机上的 `docker0` 桥接设备会分配一个 IP 地址范围（默认是 `172.17.0.0/16`），用于为容器分配 IP 地址。

## 为容器分配网络接口

- 获得IP地址：容器会从 `docker0` 的 IP 地址池中分配一个唯一的 IP 地址（如 `172.17.0.2`）。
- 连接到docker0：每个容器启动时，Docker 会创建一个虚拟的以太网接口（如 `eth0`），并将其连接到 `docker0` 桥接设备上。